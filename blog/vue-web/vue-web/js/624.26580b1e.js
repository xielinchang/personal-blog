"use strict";(self["webpackChunkvueforblog"]=self["webpackChunkvueforblog"]||[]).push([[624],{43624:function(t,e,n){n.r(e),n.d(e,{default:function(){return z}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"background"},[t.panelShow?e("h3",[t._v("Tips: 系数范围为1~99，获取所有金币进入下一关吧！")]):t._e(),t.panelShow?e("div",{staticClass:"panel block"},[e("div",{staticClass:"panel-item"},[t._v(" 选取关卡： "),e("my-select",{attrs:{options:t.levelOptions,selected:t.selectedLevel},on:{"change-select":t.changeSelect}})],1),e("div",{staticClass:"panel-item"},[t._v(" 速度系数： "),e("my-input",{attrs:{placeholder:"参考8-18"},model:{value:t.playerXSpeed,callback:function(e){t.playerXSpeed=e},expression:"playerXSpeed"}})],1),e("div",{staticClass:"panel-item"},[t._v(" 重力系数： "),e("my-input",{attrs:{placeholder:"参考30-50"},model:{value:t.gravity,callback:function(e){t.gravity=e},expression:"gravity"}})],1),e("div",{staticClass:"panel-item"},[t._v(" 弹跳系数 ： "),e("my-input",{attrs:{placeholder:"参考16-24"},model:{value:t.jumpSpeed,callback:function(e){t.jumpSpeed=e},expression:"jumpSpeed"}})],1),e("div",{staticClass:"panel-item",staticStyle:{"justify-content":"flex-end"}},[e("my-button",{on:{click:t.start}},[t._v("开始")])],1)]):e("my-button",{staticClass:"exit",attrs:{type:"danger"},on:{click:t.exit}},[t._v("退出")])],1)},o=[];n(57658);const i=["                                                    \n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n..................................................................###...........\n...................................................##......##....##+##..........\n....................................o.o......##..................#+++#..........\n.................................................................##+##..........\n...................................#####..........................#v#...........\n............................................................................##..\n..##......................................o.o................................#..\n..#.....................o....................................................#..\n..#......................................#####.............................o.#..\n..#..........####.......o....................................................#..\n..#..@.......#..#................................................#####.......#..\n..############..###############...####################.....#######...#########..\n..............................#...#..................#.....#....................\n..............................#+++#..................#+++++#....................\n..............................#+++#..................#+++++#....................\n..............................#####..................#######....................\n................................................................................\n................................................................................\n","                                                                     \n................................................................................\n................................................................................\n....###############################.............................................\n...##.............................##########################################....\n...#.......................................................................##...\n...#....o...................................................................#...\n...#................................................=.......................#...\n...#.o........################...................o..o...........v........o..#...\n...#.........................#..............................................#...\n...#....o....................##########.....###################....##########...\n...#..................................#+++++#.................#....#............\n...###############....oo......=o.o.o..#######.###############.#....#............\n.....#...............o..o.............#.......#......#........#....#............\n.....#....................#############..######.####.#.########....########.....\n.....#.............########..............#...........#.#..................#.....\n.....#..........####......####...#####################.#..................#.....\n.....#........###............###.......................########....########.....\n.....#.......##................#########################......#....#............\n.....#.......#................................................#....#............\n.....###......................................................#....#............\n.......#...............o...........................................#............\n.......#...............................................o...........#............\n.......#########......###.....############.........................##...........\n.............#..................#........#####....#######.o.........########....\n.............#++++++++++++++++++#............#....#.....#..................#....\n.............#++++++++++++++++++#..........###....###...####.o.............#....\n.............####################..........#........#......#.....|.........#....\n...........................................#++++++++#......####............#....\n...........................................#++++++++#.........#........@...#....\n...........................................#++++++++#.........##############....\n...........................................##########...........................\n................................................................................\n","\n......................................#++#........................#######....................................#+#..\n......................................#++#.....................####.....####.................................#+#..\n......................................#++##########...........##...........##................................#+#..\n......................................##++++++++++##.........##.............##...............................#+#..\n.......................................##########++#.........#....................................o...o...o..#+#..\n................................................##+#.........#.....o...o....................................##+#..\n.................................................#+#.........#................................###############++#..\n.................................................#v#.........#.....#...#........................++++++++++++++##..\n.............................................................##..|...|...|..##............#####################...\n..............................................................##+++++++++++##............v........................\n...............................................................####+++++####......................................\n...............................................#.....#............#######........###.........###..................\n...............................................#.....#...........................#.#.........#.#..................\n...............................................#.....#.............................#.........#....................\n...............................................#.....#.............................##........#....................\n...............................................##....#.............................#.........#....................\n...............................................#.....#......o..o.....#...#.........#.........#....................\n...............#######........###...###........#.....#...............#...#.........#.........#....................\n..............##.....##.........#...#..........#.....#.....######....#...#...#########.......#....................\n.............##.......##........#.o.#..........#....##...............#...#...#...............#....................\n.....@.......#.........#........#...#..........#.....#...............#...#...#...............#....................\n....###......#.........#........#...#..........#.....#...............#...#####...######......#....................\n....#.#......#.........#.......##.o.##.........#.....#...............#.....o.....#.#.........#....................\n++++#.#++++++#.........#++++++##.....##++++++++##....#++++++++++.....#.....=.....#.#.........#....................\n++++#.#++++++#.........#+++++##.......##########.....#+++++++##+.....#############.##..o.o..##....................\n++++#.#++++++#.........#+++++#....o.................##++++++##.+....................##.....##.....................\n++++#.#++++++#.........#+++++#.....................##++++++##..+.....................#######......................\n++++#.#++++++#.........#+++++##.......##############++++++##...+..................................................\n++++#.#++++++#.........#++++++#########++++++++++++++++++##....+..................................................\n++++#.#++++++#.........#++++++++++++++++++++++++++++++++##.....+..................................................\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n","\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n........................................o.....................................................................\n..............................................................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n.......................................###....................................................................\n.......................................#.#.................+++........+++..###................................\n.......................................#.#.................+#+........+#+.....................................\n.....................................###.###................#..........#......................................\n......................................#...#.................#...oooo...#.......###............................\n......................................#...#.................#..........#......#+++#...........................\n......................................#...#.................############.......###............................\n.....................................##...##......#...#......#................................................\n......................................#...#########...########..............#.#...............................\n......................................#...#...........#....................#+++#..............................\n......................................#...#...........#.....................###...............................\n.....................................##...##..........#.......................................................\n......................................#...#=.=.=.=....#............###........................................\n......................................#...#...........#...........#+++#.......................................\n......................................#...#....=.=.=.=#.....o......###.......###..............................\n.....................................##...##..........#.....................#+++#.............................\n..............................o...o...#...#...........#.....#................##v........###...................\n......................................#...#...........#..............#.................#+++#..................\n.............................###.###.###.###.....o.o..#++++++++++++++#...................v#...................\n.............................#.###.#.#.###.#..........#++++++++++++++#........................................\n.............................#.............#...#######################........................................\n.............................##...........##.........................................###......................\n..###.........................#.....#.....#.........................................#+++#................###..\n..#.#.........................#....###....#..........................................###.................#.#..\n..#...........................#....###....#######........................#####.............................#..\n..#...........................#...........#..............................#...#.............................#..\n..#...........................##..........#..............................#.#.#.............................#..\n..#.......................................#.......|####|....|####|.....###.###.............................#..\n..#................###.............o.o....#..............................#.........###.....................#..\n..#...............#####.......##..........#.............................###.......#+++#..........#.........#..\n..#...............o###o.......#....###....#.............................#.#........###..........###........#..\n..#................###........#############..#.oo.#....#.oo.#....#.oo..##.##....................###........#..\n..#......@..........#.........#...........#++#....#++++#....#++++#....##...##....................#.........#..\n..#############################...........#############################.....################################..\n..............................................................................................................\n..............................................................................................................\n","\n..................................................................................................###.#.......\n......................................................................................................#.......\n..................................................................................................#####.......\n..................................................................................................#...........\n..................................................................................................#.###.......\n..........................o.......................................................................#.#.#.......\n.............................................................................................o.o.o###.#.......\n...................###................................................................................#.......\n.......+..o..+................................................#####.#####.#####.#####.#####.#####.#####.......\n.......#.....#................................................#...#.#...#.#...#.#...#.#...#.#...#.#...........\n.......#=.o..#............#...................................###.#.###.#.###.#.###.#.###.#.###.#.#####.......\n.......#.....#..................................................#.#...#.#...#.#...#.#...#.#...#.#.....#.......\n.......+..o..+............o..................................####.#####.#####.#####.#####.#####.#######.......\n..............................................................................................................\n..........o..............###..............................##..................................................\n..............................................................................................................\n..............................................................................................................\n......................................................##......................................................\n...................###.........###............................................................................\n..............................................................................................................\n..........................o.....................................................#......#......................\n..........................................................##.....##...........................................\n.............###.........###.........###.................................#..................#.................\n..............................................................................................................\n.................................................................||...........................................\n..###########.................................................................................................\n..#.........#.o.#########.o.#########.o.##................................................#...................\n..#.........#...#.......#...#.......#...#.................||..................#.....#.........................\n..#..@......#####...o...#####...o...#####.....................................................................\n..#######.....................................#####.......##.....##.....###...................................\n........#=..................=................=#...#.....................###...................................\n........#######################################...#+++++++++++++++++++++###+++++++++++++++++++++++++++++++++++\n..................................................############################################################\n..............................................................................................................\n"];class r{constructor(t,e){this.x=t,this.y=e}plus(t){return new r(this.x+t.x,this.y+t.y)}times(t){return new r(this.x*t,this.y*t)}}class l{constructor(t){const e=t.trim().split("\n").map((t=>[...t]));this.height=e.length,this.width=e[0].length,this.startActors=[],this.rows=e.map(((t,e)=>t.map(((t,n)=>{const s=u[t];return"string"===typeof s?s:(this.startActors.push(s.create(new r(n,e),t)),"empty")}))))}}class a{constructor(t,e,n){this.level=t,this.actors=e,this.status=n}static start(t){return new a(t,t.startActors,"playing")}get player(){return this.actors.find((t=>"player"===t.type))}}class c{constructor(t,e){this.pos=t,this.speed=e}get type(){return"player"}static create(t){return new c(t.plus(new r(0,-.5)),new r(0,0))}}c.prototype.size=new r(.6,1.2);class p{constructor(t,e,n){this.pos=t,this.speed=e,this.reset=n}get type(){return"lava"}static create(t,e){return"="===e?new p(t,new r(2,0)):"|"===e?new p(t,new r(0,2)):"v"===e?new p(t,new r(0,3)):void 0}}p.prototype.size=new r(1,1);class h{constructor(t,e,n){this.pos=t,this.basePos=e,this.wobble=n}get type(){return"coin"}static create(t){return new h(t,t,Math.random()*Math.PI*2)}}h.prototype.size=new r(.6,.6);const u={".":"empty","#":"wall","+":"lava","@":c,o:h,"=":p,"|":p,v:p};function y(t,e,...n){const s=document.createElement(t);for(const o of Object.keys(e))s.setAttribute(o,e[o]);for(const o of n)s.appendChild(o);return s}class d{constructor(t,e){this.dom=y("div",{class:"game"},w(e)),this.actorLayer=null,t.appendChild(this.dom)}clear(){this.dom.remove()}}const v=13;function w(t){return y("table",{class:"map-table",style:`width: ${t.width*v}px`},...t.rows.map((t=>y("tr",{style:`height: ${v}px`},...t.map((t=>y("td",{class:t})))))))}function m(t){return y("div",{},...t.map((t=>{const e=y("div",{class:`actor ${t.type}`});return e.style.width=t.size.x*v+"px",e.style.height=t.size.y*v+"px",e.style.left=t.pos.x*v+"px",e.style.top=t.pos.y*v+"px",e})))}function f(t,e){return t.pos.x+t.size.x>e.pos.x&&t.pos.x<e.pos.x+e.size.x&&t.pos.y+t.size.y>e.pos.y&&t.pos.y<e.pos.y+e.size.y}d.prototype.syncState=function(t){this.actorLayer&&this.actorLayer.remove(),this.actorLayer=m(t.actors),this.dom.appendChild(this.actorLayer),this.dom.className=`game ${t.status}`,this.scrollPlayerIntoView(t)},d.prototype.scrollPlayerIntoView=function(t){const e=this.dom.clientWidth,n=this.dom.clientHeight,s=e/3,o=this.dom.scrollLeft,i=o+e,r=this.dom.scrollTop,l=r+n,a=t.player,c=a.pos.plus(a.size.times(.5)).times(v);c.x<o+s?this.dom.scrollLeft=c.x-s:c.x>i-s&&(this.dom.scrollLeft=c.x+s-e),c.y<r+s?this.dom.scrollTop=c.y-s:c.y>l-s&&(this.dom.scrollTop=c.y+s-n)},l.prototype.touches=function(t,e,n){for(var s=Math.floor(t.x),o=Math.ceil(t.x+e.x),i=Math.floor(t.y),r=Math.ceil(t.y+e.y),l=i;l<r;l++)for(var a=s;a<o;a++){const t=a<0||a>=this.width||l<0||l>=this.height,e=t?"wall":this.rows[l][a];if(e===n)return!0}return!1},a.prototype.update=function(t,e){const n=this.actors.map((n=>n.update(t,this,e)));let s=new a(this.level,n,this.status);if("playing"!==s.status)return s;const o=s.player;if(this.level.touches(o.pos,o.size,"lava"))return new a(this.level,n,"lost");for(const i of n)i!==o&&f(i,o)&&(s=i.collide(s));return s},p.prototype.collide=function(t){return new a(t.level,t.actors,"lost")},h.prototype.collide=function(t){const e=t.actors.filter((t=>t!==this));let n=t.status;return e.some((t=>"coin"===t.type))||(n="won"),new a(t.level,e,n)};const g=8,x=.1;h.prototype.update=function(t){const e=this.wobble+t*g,n=Math.sin(e)*x;return new h(this.basePos.plus(new r(0,n)),this.basePos,e)},p.prototype.update=function(t,e){const n=this.pos.plus(this.speed.times(t));return e.level.touches(n,this.size,"wall")?this.reset?new p(this.reset,this.speed,this.reset):new p(this.pos,this.speed.times(-1)):new p(n,this.speed,this.reset)};var b={name:"SuperMarry",data(){return{arrowKeys:{},levelOptions:[{label:"关卡一",value:0},{label:"关卡二",value:1},{label:"关卡三",value:2},{label:"关卡四",value:3},{label:"关卡五",value:4}],selectedLevel:{label:"关卡一",value:0},playerXSpeed:12,gravity:30,jumpSpeed:16,panelShow:!0,stop:!1}},mounted(){console.log(h.prototype)},methods:{changeSelect(t,e){this.selectedLevel.label=t,this.selectedLevel.value=e},start(){this.playerXSpeed&&this.gravity&&this.jumpSpeed&&(this.playerXSpeed<100&&this.gravity<100&&this.jumpSpeed<100?(this.initPlayer(),this.panelShow=!1,this.stop=!1,this.runGame(i,d)):this.$msg({content:"所有的系数的范围为1-99",type:"info"}))},exit(){this.panelShow=!0,this.stop=!0},initPlayer(){const t=1*this.playerXSpeed,e=1*this.gravity,n=1*this.jumpSpeed;c.prototype.update=function(s,o,i){let l=0;i.ArrowLeft&&(l-=t),i.ArrowRight&&(l+=t);let a=this.pos;const p=a.plus(new r(l*s,0));o.level.touches(p,this.size,"wall")||(a=p);let h=this.speed.y+s*e;const u=a.plus(new r(0,h*s));return o.level.touches(u,this.size,"wall")?h=i.ArrowUp&&h>0?-n:0:a=u,new c(a,new r(l,h))}},async runGame(t,e){let n=this.selectedLevel.value;while(n<t.length){const s=await this.runLevel(new l(t[n]),e);"won"===s&&++n}},runLevel(t,e){const n=new e(document.querySelector(".background"),t);let s=a.start(t),o=1;return this.arrowKeys=this.trackKeys(["ArrowLeft","ArrowRight","ArrowUp"]),new Promise((t=>{this.runAnimation((e=>(s=s.update(e,this.arrowKeys),n.syncState(s),"playing"===s.status?!this.stop||(n.clear(),!1):o>0?(o-=e,!0):(n.clear(),t(s.status),!1))))}))},runAnimation(t){let e=null;function n(s){if(null!=e){const n=Math.min(s-e,100)/1e3;if(!1===t(n))return}e=s,requestAnimationFrame(n)}requestAnimationFrame(n)},trackKeys(t){const e=Object.create(null);function n(n){t.includes(n.key)&&(e[n.key]="keydown"===n.type,n.preventDefault())}return window.addEventListener("keydown",n),window.addEventListener("keyup",n),e}}},S=b,k=n(1001),L=(0,k.Z)(S,s,o,!1,null,null,null),z=L.exports}}]);